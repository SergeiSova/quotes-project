{% extends 'quotes/base.html' %}
{% block title %}Ğ¢ĞĞŸ Ñ†Ğ¸Ñ‚Ğ°Ñ‚{% endblock %}
{% block content %}
  <div class="card" style="margin-bottom:16px">
    <form method="get" class="row" style="gap:8px">
      <label>Ğ¢Ğ¸Ğ¿:
        <select name="type" class="btn">
          <option value="">â€” Ğ»ÑĞ±Ğ¾Ğ¹ â€”</option>
          <option value="movie" {% if filter_type == 'movie' %}selected{% endif %}>Ğ¤Ğ¸Ğ»ÑŒĞ¼</option>
          <option value="book" {% if filter_type == 'book' %}selected{% endif %}>ĞšĞ½Ğ¸Ğ³Ğ°</option>
          <option value="other" {% if filter_type == 'other' %}selected{% endif %}>Ğ”Ñ€ÑƒĞ³Ğ¾Ğµ</option>
        </select>
      </label>
      <label>Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº:
        <input type="text" name="source" value="{{ filter_source }}" class="btn" placeholder="Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, The Matrix" />
      </label>
      <button class="btn" type="submit">Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€</button>
      <a class="btn" href="{% url 'quotes:top_quotes' %}">Ğ¡Ğ±Ñ€Ğ¾Ñ</a>
    </form>
  </div>

  <div class="card" style="margin-bottom:16px">
    <h2 style="margin:0 0 12px 0">Ğ¢ĞĞŸâ€‘10 Ğ¿Ğ¾ Ğ»Ğ°Ğ¹ĞºĞ°Ğ¼</h2>
    <ol>
      {% for q in top10 %}
        <li style="margin-bottom:8px">
          Â«{{ q.text }}Â» â€” <span class="muted">{{ q.source.name }}</span>
          <span class="muted">(ğŸ‘ {{ q.likes }} Â· ğŸ‘ {{ q.dislikes }} Â· ğŸ‘ï¸ {{ q.views }})</span>
        </li>
      {% empty %}
        <li>ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….</li>
      {% endfor %}
    </ol>
  </div>

  <div class="card" style="margin-bottom:16px">
    <h3 style="margin:0 0 12px 0">Ğ¢ĞĞŸâ€‘10 Ğ¿Ğ¾ Wilson score</h3>
    <ol>
      {% for q in top_wilson %}
        <li>Â«{{ q.text }}Â» â€” <span class="muted">{{ q.source.name }}</span>
          <span class="muted">(score: {{ q.wilson|floatformat:3 }} Â· ğŸ‘ {{ q.likes }} Â· ğŸ‘ {{ q.dislikes }})</span>
        </li>
      {% empty %}
        <li>ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….</li>
      {% endfor %}
    </ol>
  </div>

  <div class="card" style="margin-bottom:16px">
    <h3 style="margin:0 0 12px 0">Ğ¡Ğ°Ğ¼Ñ‹Ğµ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ°Ñ‚Ñ€Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ</h3>
    <ol>
      {% for q in most_viewed %}
        <li>Â«{{ q.text }}Â» â€” <span class="muted">{{ q.source.name }}</span>
          <span class="muted">(ğŸ‘ï¸ {{ q.views }} Â· ğŸ‘ {{ q.likes }})</span></li>
      {% empty %}
        <li>ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….</li>
      {% endfor %}
    </ol>
  </div>

  <div class="card">
    <h3 style="margin:0 0 12px 0">Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° Ğ¿Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ°Ğ¼</h3>
    <table>
      <thead>
        <tr><th>Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº</th><th>Ğ¦Ğ¸Ñ‚Ğ°Ñ‚</th><th>Ğ›Ğ°Ğ¹ĞºĞ¾Ğ²</th><th>Ğ”Ğ¸Ğ·Ğ»Ğ°Ğ¹ĞºĞ¾Ğ²</th><th>ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¾Ğ²</th></tr>
      </thead>
      <tbody>
      {% for row in by_sources %}
        <tr>
          <td>{{ row.source__name }}</td>
          <td>{{ row.cnt }}</td>
          <td>{{ row.total_likes|default:0 }}</td>
          <td>{{ row.total_dislikes|default:0 }}</td>
          <td>{{ row.total_views|default:0 }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
